Azure Scalable Web Application InfrastructureThis Terraform configuration deploys a highly available and scalable web application environment on Microsoft Azure. It provisions core networking components, a load balancer, a virtual machine scale set with autoscaling, and a NAT Gateway for secure outbound connectivity.Table of ContentsOverviewDeployed Azure ResourcesPrerequisitesGetting Started1. Clone the Repository2. Authenticate to Azure3. Initialize Terraform4. Plan the Deployment5. Apply the ConfigurationAccessing the Application/VMsDestroying ResourcesReferencesOverviewThis project automates the deployment of a robust and scalable web application infrastructure on Azure. It's designed to provide a foundational environment for hosting web services, ensuring high availability, network security, and automatic scaling capabilities.The infrastructure includes:A dedicated Azure Resource Group to contain all resources.A Virtual Network (VNet) and Subnet for isolated networking.Network Security Group (NSG) rules to control inbound traffic (HTTP, HTTPS, SSH).Public IP addresses for external access.An Azure Load Balancer to distribute incoming web traffic across multiple instances.An Orchestrated Virtual Machine Scale Set (VMSS) running Ubuntu, providing the compute capacity.Autoscaling settings for the VMSS to automatically adjust instance count based on demand.An Azure NAT Gateway for secure and centralized outbound internet access from the VMSS instances.Deployed Azure ResourcesThe following resources are provisioned by this Terraform configuration:azurerm_resource_group: terraform-tutorial (in westus3) - Logical container for all resources.azurerm_virtual_network: terraformvnet (in westus3, 10.0.0.0/16) - Your private network.azurerm_subnet: subnet (in terraformvnet, 10.0.0.0/20) - A segment within your VNet.azurerm_network_security_group: myNSG (in westus3) - Firewall rules for inbound traffic (HTTP, HTTPS, SSH).azurerm_subnet_network_security_group_association: Associates myNSG with subnet.azurerm_public_ip:lb-publicIP (Standard SKU, westus3, zoned) - Public IP for the Load Balancer.natgw-publicIP (Standard SKU, westus3, zoned) - Public IP for the NAT Gateway.azurerm_nat_gateway: nat-Gateway (Standard SKU, westus3, zoned) - Provides secure outbound internet access.azurerm_nat_gateway_public_ip_association: Associates natgw-publicIP with nat-Gateway.azurerm_subnet_nat_gateway_association: Associates nat-Gateway with subnet.azurerm_lb: myLB (Standard SKU, westus3) - Distributes incoming traffic.azurerm_lb_backend_address_pool: myBackendAddressPool - Contains the backend VMs for the Load Balancer.azurerm_lb_probe: http-probe (Port 80) - Health check for backend instances.azurerm_lb_rule: http (Frontend Port 80 -> Backend Port 80) - Traffic forwarding rule.azurerm_lb_nat_rule: ssh (Frontend Ports 50000-50119 -> Backend Port 22) - SSH access to individual VMs.azurerm_orchestrated_virtual_machine_scale_set: vmss-terraform (Ubuntu 22.04 LTS, Standard_D2s_v4, 3 instances initially) - Scalable compute.azurerm_monitor_autoscale_setting: autoscale - Configures automatic scaling for vmss-terraform.random_pet: lb_hostname - Generates a random hostname for the Load Balancer.PrerequisitesBefore you begin, ensure you have the following installed:Terraform: Install TerraformAzure CLI: Install Azure CLIAn active Azure Subscription.Getting StartedFollow these steps to deploy the infrastructure to your Azure subscription.1. Clone the RepositoryIf you haven't already, clone this repository to your local machine:git clone <repository_url>
cd Day14-AZ-Terraform # Or the directory containing your .tf files

2. Authenticate to AzureYou need to authenticate Terraform with your Azure account. The easiest way is to use the Azure CLI:az login

Follow the prompts to complete the authentication. Ensure your subscription ID is set as an environment variable, as indicated in your previous session:$env:ARM_SUBSCRIPTION_ID = "62f3fe91-0f4a-4014-86d4-0e429ed8234b" # Replace with your actual subscription ID

Or for Linux/macOS:export ARM_SUBSCRIPTION_ID="62f3fe91-0f4a-4014-86d4-0e429ed8234b" # Replace with your actual subscription ID

3. Initialize TerraformNavigate to the directory containing your Terraform configuration files (.tf) and initialize the working directory:terraform init

This command downloads the necessary Azure provider plugins.4. Plan the DeploymentBefore applying any changes, it's good practice to review the execution plan. This command shows you what Terraform will create, modify, or destroy:terraform plan

Review the output carefully to ensure it matches your expectations. You should see 18 to add, 0 to change, 0 to destroy as seen in your provided output.5. Apply the ConfigurationOnce you are satisfied with the plan, apply the configuration to provision the resources in Azure:terraform apply --auto-approve

The --auto-approve flag will automatically confirm the plan and proceed with the deployment without requiring manual confirmation. This process may take several minutes.Accessing the Application/VMsAfter a successful terraform apply, the Load Balancer's public IP address will be available. You can typically find this in the Terraform output or directly in the Azure portal.Web Application Access: If your VMSS instances are running a web server (e.g., Nginx, Apache) on port 80, you can access your application by navigating to the Load Balancer's public IP address in a web browser.SSH Access to VMs: You can SSH into individual VMSS instances using the NAT rule. The Load Balancer's public IP and the assigned frontend port range (50000-50119) are used. For example, to connect to the first instance:ssh -i <your_ssh_private_key> azureuser@<LoadBalancer_Public_IP> -p 50000

(Replace <your_ssh_private_key> with the path to your private key and <LoadBalancer_Public_IP> with the actual IP.)Destroying ResourcesTo remove all the resources deployed by this Terraform configuration from your Azure subscription, run the following command:terraform destroy --auto-approve

Caution: This command will permanently delete all resources managed by this Terraform state. Ensure you want to remove everything before running it.ReferencesTerraform Azure Virtual Machine Scale Sets Tutorial